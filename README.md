CONTEXT
--------------------
The codes and data in this repository were created in relation to the paper "Topology and obliquity of core magnetic fields in shaping seismic properties of slowly rotating evolved stars", by Shyeh Tjing Loi, which has been accepted for publication by the journal Monthly Notices of the Royal Astronomical Society. An open-access version can be found at https://arxiv.org/abs/2104.03112

The goal of the study was to investigate the combined effects of rotation and a magnetic field on the frequencies of natural oscillation modes of stars, using first-order perturbation theory. The main codes in this repository can be subdivided into two groups:
1. Those that calculate the basic eigenmodes of the star in the absence of rotation and magnetism, and
2. Those that apply perturbation theory to obtain the modifications arising from rotation and magnetism.

There are also a number of extra files. The role of each is described below.

SUMMARY OF CONTENTS
--------------------
1. Calculation of basic eigenmodes
    * osc.m - the main code, which calls the remaining functions/routines in this section to solve for the eigenmodes given chosen input parameters (specified by the user at the beginning of the file); optionally saves the output and generates plots
    * polytrope.m - function to generate a polytropic stellar model
    * get_inout_solns.m - routine to facilitate integration of the equations of stellar oscillation to obtain inner and outer solutions
    * shoot.m - helper function to implement RK4 integration, called by get_inout_solns.m
    * EckartClass.m - function to calculate the radial order of resultant modes
2. Calculation of perturbations 
    * pertb_rot_mag.m - the main code, which calls the remaining funcions/routines in this section to calculate the perturbations to the basic eigenmodes (relevant parameters specified by the user at the beginning of the file); takes input of the format output by osc.m (an example file, modes_n4.2poly_l1.mat, is included in this repository)
    * Prendergast.m - function that generates the Prendergast (1956) magnetic field model
    * construct_spherical_harmonics.m - function that generates spherical harmonic anonymous functions
3. Miscellaneous
    * postprocessMESA.m - code for post-processing output generated by the stellar evolutionary code MESA (Modules for Experiments in Stellar Astrophysics), involving smoothing, resampling etc.; outputs files of the format required by osc.m
    * plot_Prendergast.m - code for visualising the magnetic field (not called by any of the above, just a handy function)
4. Data files
    * modes_n4.2poly_l1.mat - an example file containing the basic eigenmodes of a polytropic model with index 4.2 (Model A in the paper); this is of the format required by pertb_rot_mag.m
    * modes_MESA_2Msun_profile26_l1.mat - another example file, this time for a 2-solar mass subgiant star computed by MESA (Model C in the paper)
    * RBcmaps.mat - contains a custom colour map used by pertb_rot_mag.m to generate red/blue output diagrams
